<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="~{user/layout/default}">
	<th:block layout:fragment="customContents">
  
 <!-- ================ start banner area ================= -->
  <section class="page-banner-area" id="category">
    <div class="container h-100">
        <div class="text-center">
          <h1>íê¸°ì»µ ë“±ë¡</h1>
          <nav aria-label="breadcrumb" class="banner-breadcrumb">
            <ol class="breadcrumb">
              <li class="breadcrumb-item"><a href="/"><span class="fe fe-16 fe-home"></span></a></li>
              <li class="breadcrumb-item"><span class="fe fe-16 fe-chevron-right"></span></li>
              <li class="breadcrumb-item active" aria-current="page">íê¸°ì»µ ë“±ë¡</li>
            </ol>
          </nav>
      </div>
    </div>
  </section>
 
	  <!-- ================ end banner area ================= -->

  <!--================Point table Area =================-->
  
   <section class="order_details section-margin--small">
    <div class="container">
      <div class="order_details_table">
        <h2>Discard Cup Download</h2>
        <div class="table-responsive">
		<table class="table">
			<thead>
				<tr>
					<th  colspan="3">
					ë‹¤ìš´ ë°›ì•„ ì„œì‹ì— ë§ê²Œ ì‘ì„± í›„ ì—…ë¡œë“œ ë¶€íƒë“œë¦½ë‹ˆë‹¤ğŸ’™
					</th>
				</tr>
			</thead>
			<tbody>
				<tr  th:if="${not #lists.isEmpty(fileList)}" th:each="l, index : ${fileList}">
					<td th:text="${index.count}"></td>
					<td th:text="${l.fileOriginalName}"></td>
					<td class="td-class-file">
						<a class="btn mb-2 btn-secondary download-cupBtn" th:href="@{/admin/cup/file/download(fileIdx=${l.fileIdx})}">
							<span class="fe fe-download fe-16"></span>
						</a>
					</td>
				</tr>
				<tr th:unless="${not #lists.isEmpty(fileList)}">
					<td colspan="4">ëª©ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</td>
				</tr>
				
			</tbody>
		</table>
	</div>
	</div>
      <div class="order_details_table">
        <h2>Discard Cup Upload</h2>
        <div class="table-responsive">
        <form id="discardform" th:action="@{/partner/excel/fileupload}" method="post" enctype="multipart/form-data">
          <table class="table">
            <thead>
              <tr>
                <th scope="col">íê¸°ì»µ ì—…ë¡œë“œ</th>
                <th scope="col"></th>
                <th scope="col"></th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="washDiscardCup">
                	<input type="file" name="excelFile" id="example-fileinput" class="form-control-file">
                </td>
                <td>
                </td>
                <td>
                	<button type="submit" class="btn mb-2 btn-outline-success" id="commitBtn"><span class="fe fe-upload-cloud fe-16"></span></button>    
                </td>
              </tr>
              <tr>
                <td>
           			<h5></h5>
                </td>
                <td>
                	<h5></h5>
                </td>
                <td>
                	<h5></h5>
                </td>
              </tr>
            </tbody>
          </table> 
          </form>
         </div>
         
      <div class="order_details_table">
        <h2>Discard Cup List</h2>
        <div class="table-responsive">
          <table class="table">
            <thead>
              <tr>
                <th scope="col">NO.</th>
                <th scope="col">ì‚¬ì—…ì¥ ì½”ë“œ</th>
                <th scope="col">ì»µ QR</th>
                <th scope="col">ì—…ë°ì´íŠ¸ ë‚ ì§œ</th>
              </tr>
            </thead>
            <tbody>
            	<th:block th:unless="${#lists.isEmpty(discardCupList)}"  th:each="d,state : ${discardCupList}">
                 	<tr>
                    	 <td class="washDiscardCupCheck" th:text="${state.count+(rowPerPage*(currentPage-1))}"></td>
                     	 <td class="washDiscardCupCheck" th:text="${d.partnerInfo}"></td>
                     	 <td class="washDiscardCupCheck" th:text="${d.cupQR}"></td>
                     	<td class="washDiscardCupCheck" th:text="${d.upDateTime}"></td>
                 	</tr>
                </th:block>
                <tr>
                	<h5></h5>
                </tr>
              	<tr th:if="${#lists.isEmpty(discardCupList)}">
					<td class="washDiscardCupCheck" colspan="4">íê¸°ì»µì´ ì—†ìŠµë‹ˆë‹¤.</td>
				</tr>
            </tbody>
			 <tfoot class="tfoot-cup">
				<tr>
					<td colspan="4">
						<button type="button" class="pages btn mb-2 btn-secondary" th:unless="${currentPage==1}">ì²˜ìŒìœ¼ë¡œ</button>
						<label class="btn mb-2 btn-secondary" th:if="${currentPage==1}">ì²˜ìŒìœ¼ë¡œ</label>
						<button type="button" class="btn mb-2 btn-secondary" th:if="${currentPage>1}">ì´ì „</button>
						<label class="btn mb-2 btn-secondary" th:unless="${currentPage>1}">ì´ì „</label>
						<div class="btn-group mr-2" role="group" aria-label="First group">
							<th:block th:each="num : ${#numbers.sequence(startPageNum,endPageNum)}" >
								<button type="button" class="btn mb-2 btn-secondary" th:if="${currentPage != num}" th:text="${num}"></button>
								<label class="btn mb-2 btn-secondary current-page-btn foot-pg" th:if="${currentPage == num}" th:text="${num}"></label>
							</th:block>
						</div>				
						<button type="button" class="btn mb-2 btn-secondary" th:if="${currentPage<lastPage}">ë‹¤ìŒ</button>
						<label class="btn mb-2 btn-secondary" th:unless="${currentPage<lastPage}">ë‹¤ìŒ</label>
						<button type="button" class="pages btn mb-2 btn-secondary lastPg" th:unless="${currentPage==lastPage}" th:attr="lastPage=${lastPage}">ë§ˆì§€ë§‰ìœ¼ë¡œ</button>
						<label class="btn mb-2 btn-secondary" th:if="${currentPage==lastPage}">ë§ˆì§€ë§‰ìœ¼ë¡œ</label>
					</td>
				</tr>
			</tfoot>
         </table>
       </div>
      </div>
     </div>
   </div>
  </section>
  <!--================End Order Details Area =================-->

   </th:block>
   	<th:block layout:fragment="customJs">
		<script type="text/javascript" th:inline="javascript">
		let msg = '[[${msg}]]';
		console.log(msg);
		if(msg != 'null') alert(msg);
		
		
		// íƒ­ ë‚´ì˜ í˜ì´ì§€ë„¤ì´ì…˜ í´ë¦­í–ˆì„ ë•Œ í•´ë‹¹ íƒ­ ìœ ì§€í•˜ê¸° (getë°©ì‹ìœ¼ë¡œ ajax ìš”ì²­ - ë¦¬ë‹¤ì´ë ‰íŠ¸)	
		$('tfoot button').click(e => {		
			e.preventDefault();
			e.stopPropagation();
			
			//let tableId = $('.tab-pane').attr('id');
			
			let currentPage;
			
			if($(e.target).text() == 'ì²˜ìŒìœ¼ë¡œ') currentPage = 1;
			else if($(e.target).text() == 'ì´ì „') currentPage = Number($('.foot-pg').text()) - 1;
			else if($(e.target).text() == 'ë‹¤ìŒ') currentPage = Number($('.foot-pg').text()) + 1;
			else if($(e.target).text() == 'ë§ˆì§€ë§‰ìœ¼ë¡œ') currentPage = Number($('.lastPg').attr('lastPage'));
			else currentPage = $(e.target).text();
			
		    currentPage = parseInt(currentPage);
			
			console.log(currentPage);
			
			
		 
		 	 const request = $.ajax({
					url: '/partner/washDiscardCupList',
					method: 'GET',
					data: { 'currentPage' : currentPage},
					dataType: 'text'
		 	});

					request.done(function( response ) {
	   					if(response){
	   						const data = JSON.parse(response);
	   						data.
							console.log(response)
	   	    				return false;
	   					}else{
	   						console.log(response);
	   					}
	   				});
	   				 
	   				request.fail(function( jqXHR, textStatus ) {
						alert( "Request failed: " + textStatus );
	   				});
		});      
		
		</script>
	</th:block>
</html>